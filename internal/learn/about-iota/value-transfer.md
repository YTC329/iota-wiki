---
id: value-transfer
title: Value Transfer
description: Learn how the IOTA Cryptocurrency Protocol transfers the native IOTA Tokens.
---

# IOTA 價值交易

本頁解釋了 IOTA 代幣如何在 IOTA 網絡中發送和接收，並鏈接到更詳細的內容。

## 簡單的例子：

為了解釋 IOTA 代幣如何從一個地址轉移到另一個地址，本主題遵循三個字符：Alice、Bob 和 Charlie。

### 目標

Charlie 想將 10i 轉移給 Bob。

### 糾纏中有什麼

在這個例子中，Alice 有 10i 轉給 Bob。因此，糾纏現在包含一個將這些 10i 轉移給 Bob 的價值訊息。

### 選擇附加訊息的位置

要將 10i 轉移給 Bob，Charlie 必須將價值訊息附加到糾纏。為此，他需要 1 到 8 條可以附加到自己的訊息中的提示訊息。

為了獲得這些提示訊息，Charlie 從一個節點請求它們。

節點通過使用一種稱為 **Uniform Random Tip Selection** (URTS) 的算法來選擇這些訊息。該算法選擇 1 到 8 條有效的提示訊息，這些提示訊息會導致有效的分類帳狀態。

- 帳本狀態是所有在糾纏中轉移 IOTA 代幣的價值訊息的記錄，包括地址上所有餘額的狀態。這種狀態必須始終保持平衡：IOTA 代幣的總數必須始終與總供應量相加。

通過使用節點給他的提示訊息，Charlie 讓網絡知道他也在批准他們和他們的歷史。如果這些訊息中的任何一條被證明是無效的，Charlie 的訊息也將被視為無效，其他節點在節點選擇期間不會選擇 Charlie 的訊息。
- 在提示選擇期間，節點會忽略糾纏的無效部分。這些術語是 **無效的子糾纏**。

### 簽署訊息

為了向節點證明他確實是他地址中 IOTA 代幣的所有者，Charlie 用他的私鑰簽署了一條輸入訊息。此輸入訊息從他的地址中提取 10i。

Charlie 然後創建一個輸出訊息，將該 10i 存入 Bob 的地址。此訊息不需要簽名，因為它不會提取 IOTA 代幣。

然後 Charlie 將所有訊息放入 UTXO 中，並將它們發送到 IOTA 網絡上的節點。

### 等待訊息被確認

任何人都可以隨時向節點發送訊息。因此，選擇有效的提示訊息並不總是一件簡單的事情。但是，里程碑根據確定性排序確定包含和確認哪些訊息。

例如，如果 Alice 實際上將兩條訊息附加到糾纏：一條將 10i 傳輸給 Bob，另一條將 10i 傳輸給 Charlie？這些消息一起被稱為**雙花**，因為它們試圖將相同的 IOTA 代幣轉移到不同的地址。

Alice 的兩條訊息都不能成為帳本狀態的一部分，因為這會導致 Alice 地址的餘額為負數：負 10i。

糾纏中的訊息由稱為**里程碑**的特殊訊息確認。里程碑由一個名為協調員的特殊節點發布，該節點由 IOTA 基金會運營，因此仍然是共識的集中部分。

在 Charlie 的訊息被里程碑確認後，節點更新他和 Bob 的餘額以反映 10i 轉移到 Bob 的地址。 Bob 現在可以使用他的新 IOTA 代幣。

讓我們更詳細地了解一下參與者所採取的各個步驟：

## 客戶端

一切從客戶端開始。客戶端是為用戶（無論是人、機器還是設備）發起和創建 IOTA 交易的軟件。大多數用戶委託人將以錢包軟件的形式出現，例如 [IOTA Firefly Wallet](https://firefly.iota.org/)。

還提供了面向專業用戶的簡單命令行工具，例如 [CLI 錢包](https://github.com/iotaledger/cli-wallet/)。

機器、傳感器和設備等將使用 IOTA 錢包庫的代碼來自主創建和執行交易。

要將價值交易發送到 IOTA 網絡，客戶端會創建一條 IOTA 訊息，其中包含**簽名的交易有效負載**。在這個有效載荷中，所有數據都被指定來告訴 IOTA 網絡有多少代幣從地址 A（由訊息的發布者擁有）應該轉移到地址 B，並使得相應地升級 IOTA Ledger 的狀態成為可能。

簽名的交易有效負載必須包含一個數字簽名，以保證交易的發送者是當前存儲這些資金的地址的所有者。這是通過使用該地址的私鑰簽署交易來保證的。公鑰（也是訊息的一部分）將用於驗證資金的所有權。在此處閱讀有關私鑰和公鑰如何協同工作的更多信息：

下一步將是客戶端連接到 IOTA 網絡中的一個節點，並要求該節點提供有效的提示以包含在消息中。在客戶端知道提示（糾纏的前一到八個消息之間）之後，它們可以包含在訊息中，因此在糾纏中創建此訊息的引用路徑。最後，客戶端現在將這個消息（包括交易有效負載）提交給節點進行驗證和處理。

## 節點

節點是 IOTA 網絡中所有訊息的簿記員、決策者和驗證者。 IOTA 網絡中的每個節點在任何給定時間都知道 IOTA 網絡中所有現有地址的確切狀態和包含值。這稱為**帳本狀態**。

節點也是客戶端進入網絡的入口點。客戶端通過節點中的指定端口向節點提交訊息。該節點在其收件箱中收集該入口端口的所有到達流量，並首先檢查該訊息是否格式正確並且可以被處理。

如果節點可以讀取訊息的所有位並且節點檢測到訊息中包含的簽名交易有效負載，則驗證過程開始。

首先，節點驗證嘗試發送這些資金的地址是否具有執行此操作所需的餘額。因此，他檢查了他當前對該地址的了解（他的帳本狀態），以查看該地址是否有足夠的資金。該節點還檢查網絡中是否存在已知的衝突，這將使花費比當前位於地址上的資金更多的資金成為可能（換句話說，雙花）。因此，如果當前存在另一條訊息並且知道要花費地址的相同資金的節點，則會檢測到衝突，並且兩條訊息都將被處理為衝突解決方案 - 稍後將詳細介紹此過程。

如果沒有檢測到衝突，節點的下一步是提交請求的帳本狀態更新：“從地址 A 移除金額資金 x 並將這些金額添加到地址 B”。提交是通過所謂的 **gossip 協議** 進行的。

節點將其更新的帳本狀態發送給所有直接連接的相鄰節點。每個節點都連接到其他幾個節點。這些節點從它們的鄰居那裡接收更新的帳本狀態。每個節點將請求與其當前已知的分類帳版本進行比較，並再次檢查是否存在衝突。如果沒有發現衝突，節點更新他的帳本狀態並再次將更新後的狀態發送給他的鄰居。

這導致帳本更新通過網絡以極快的速度傳播，並在幾秒鐘內到達網絡中的每個節點，因此被接受和確認。在這個階段，訊息已經完全確認，被認為是可靠的。它現在將被添加到每個節點的提示池中，並且可以用作新訊息的參考。
